<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-wall.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-wall.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="baidu-site-verification" content="code-jsxllPgZAX">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|JetBrains Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"thysrael.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="一、系统结构设计1.1 体系结构1.1.1 总体结构项目的整体架构如图所示">
<meta property="og:type" content="article">
<meta property="og:title" content="DBMS-实现报告">
<meta property="og:url" content="https://thysrael.github.io/posts/c89ebf90/index.html">
<meta property="og:site_name" content="钟鼓楼">
<meta property="og:description" content="一、系统结构设计1.1 体系结构1.1.1 总体结构项目的整体架构如图所示">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/项目架构.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/文档架构图.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/功能架构.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221135549266.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221231316744.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221232351946.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221232558406.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221232758214.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221233317411.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221233457074.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221234005472.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222001923805.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222002346692.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222002421520.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221234427928.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221234648414.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221234724546.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221235603410.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221235714354.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221221235843792.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222000308893.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222000728709.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222000843237.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222002901744.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222003213771.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222003550614.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222003608127.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222001339919.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20221222001656642.png">
<meta property="og:image" content="https://thysrael.github.io/posts/c89ebf90/image-20230105122315380.png">
<meta property="article:published_time" content="2023-01-05T04:19:40.000Z">
<meta property="article:modified_time" content="2025-08-15T12:16:47.755Z">
<meta property="article:author" content="Thysrael">
<meta property="article:tag" content="直观理解">
<meta property="article:tag" content="DBMS">
<meta property="article:tag" content="S5课上">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://thysrael.github.io/posts/c89ebf90/项目架构.png">

<link rel="canonical" href="https://thysrael.github.io/posts/c89ebf90/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>DBMS-实现报告 | 钟鼓楼</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1K2CH25PS7"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-1K2CH25PS7');
  </script>

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="钟鼓楼" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
      <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/thysrael" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">钟鼓楼</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">钟楼瘦，鼓楼胖</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">31</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">70</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">203</span></a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resource/" rel="section"><i class="fa fa-book fa-fw"></i>Resources</a>

  </li>
        <li class="menu-item menu-item-projects">

    <a href="/projects/" rel="section"><i class="fa fa-briefcase fa-fw"></i>Projects</a>

  </li>
        <li class="menu-item menu-item-friends">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>Friends</a>

  </li>
        <li class="menu-item menu-item-roam">

    <a href="/obsidian-quartz/" rel="section"><i class="fa fa-sitemap fa-fw"></i>Roam</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thysrael.github.io/posts/c89ebf90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar2.png">
      <meta itemprop="name" content="Thysrael">
      <meta itemprop="description" content="Can you hear me?">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="钟鼓楼">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          DBMS-实现报告
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-01-05 12:19:40" itemprop="dateCreated datePublished" datetime="2023-01-05T12:19:40+08:00">2023-01-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-15 20:16:47" itemprop="dateModified" datetime="2025-08-15T20:16:47+08:00">2025-08-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DBMS/" itemprop="url" rel="index"><span itemprop="name">DBMS</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>30k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>28 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="一、系统结构设计"><a href="#一、系统结构设计" class="headerlink" title="一、系统结构设计"></a>一、系统结构设计</h1><h2 id="1-1-体系结构"><a href="#1-1-体系结构" class="headerlink" title="1.1 体系结构"></a>1.1 体系结构</h2><h3 id="1-1-1-总体结构"><a href="#1-1-1-总体结构" class="headerlink" title="1.1.1 总体结构"></a>1.1.1 总体结构</h3><p>项目的整体架构如图所示</p>
<p><img src="/posts/c89ebf90/项目架构.png" alt=""></p>
<p>该项目是部署在云端的 Web 应用，用户通过浏览器访问该应用。应用开发可以分为三个部分，前端开发，后端开发和文档开发。</p>
<h3 id="1-1-2-前端结构"><a href="#1-1-2-前端结构" class="headerlink" title="1.1.2 前端结构"></a>1.1.2 前端结构</h3><p><strong>assets</strong>：</p>
<ul>
<li>用于存储静态资源。</li>
<li>包括网站图片与字体。</li>
</ul>
<p><strong>components</strong>：</p>
<ul>
<li>多次重复使用的或者功能较为独立的 Vue 组件。</li>
<li>包括：固定按钮、侧边栏、导航栏、密码修改表单、排行榜、计分板、文件上传器。</li>
</ul>
<p><strong>router</strong>：</p>
<ul>
<li>控制应用路由的 JS 文件。</li>
<li>应用采用二级路由的机制，所以一共有多个 JS 文件，分别记录课程页面组，活动页面组，个人页面组和管理页面组的子路由。</li>
</ul>
<p><strong>store</strong>：</p>
<ul>
<li>网页会话存储，可以在客户端存储一些信息，存储寿命与该次会话寿命一致，即网页关闭则存储失效。</li>
<li>store中包含两个存储对象，一是注册时基本信息的存储，在注册密码页发送请求时一起调用；二是用户token。</li>
</ul>
<p><strong>views</strong>：</p>
<ul>
<li>应用的界面 Vue 文件。</li>
<li>具有课程、活动、个人、管理四个子文件夹，这些子文件夹下存储着不同的页面。</li>
</ul>
<h3 id="1-1-3-后端结构"><a href="#1-1-3-后端结构" class="headerlink" title="1.1.3 后端结构"></a>1.1.3 后端结构</h3><p>后端采用 Django 框架实现。文件结构如下：</p>
<ul>
<li><p><strong>app</strong></p>
<ul>
<li><p><strong>migrations</strong><br>这个文件夹中时 Django 生成的数据库迁移代码，用于修改模型类后将修改执行到数据库。</p>
</li>
<li><p><strong>models.py</strong></p>
<p>该文件定义了模型类，对应数据库的表，具体内容见本文档第二部分。</p>
</li>
<li><p><strong>url.py</strong></p>
<p>该文件定义路由，通过设置该文件中的路由，可以将不同的请求发送到不同的视图函数中进行处理。</p>
</li>
<li><p><strong>util.py</strong></p>
</li>
</ul>
<p>该文件定义了一些工具函数，用于处理一些常用的操作，如密码加密、token生成等。</p>
<ul>
<li><strong>views</strong><ul>
<li>该文件夹中存放着视图函数，用于处理前端发送的请求。</li>
<li><strong>student</strong><br>与学生相关的视图函数 </li>
<li><strong>teacher</strong><br>与教师相关的视图函数 </li>
<li><strong>User.py</strong><br>与用户管理相关的视图函数 </li>
<li><strong>Activity.py</strong><br>与活动相关的视图函数 </li>
<li><strong>Administractor.py</strong><br>管理端相关视图函数</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>backend</strong></li>
</ul>
<p>  后端基本文件，用于进行一些配置，主要有 Django 框架生成。 </p>
<ul>
<li><strong>manage.py</strong></li>
</ul>
<p>  脚本，用于后端的部署、数据库的迁移等。</p>
<h3 id="1-1-4-文档架构"><a href="#1-1-4-文档架构" class="headerlink" title="1.1.4 文档架构"></a>1.1.4 文档架构</h3><ul>
<li><strong>TODO.md</strong>：以周为单位为规划任务，并每周进行检测。</li>
<li><strong>api.md</strong>：记录前后端交互的接口。</li>
<li><strong>style.md</strong>：记录着 Git 的提交规范和项目代码风格规范。</li>
<li><strong>report</strong>：记录着所有的需要报告。</li>
<li><strong>design</strong>：记录着所有的设计和美工文档。<ul>
<li><strong>beautify</strong>：记录着美工原则。</li>
<li><strong>analyze</strong>：记录着推荐机制的判断原理。</li>
<li><strong>其他</strong>：记录这页面的布局信息。</li>
</ul>
</li>
</ul>
<p>架构图如下所示：</p>
<p><img src="/posts/c89ebf90/文档架构图.png" alt=""></p>
<h2 id="1-2-系统实现环境"><a href="#1-2-系统实现环境" class="headerlink" title="1.2 系统实现环境"></a>1.2 系统实现环境</h2><h3 id="1-2-1-客户端环境"><a href="#1-2-1-客户端环境" class="headerlink" title="1.2.1 客户端环境"></a>1.2.1 客户端环境</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">go_frontend@<span class="token number">0.1</span><span class="token number">.0</span> <span class="token operator">/</span>home<span class="token operator">/</span>thysrael<span class="token operator">/</span>learn<span class="token operator">/</span>sem5<span class="token operator">/</span>DBSM<span class="token operator">/</span><span class="token number">4</span>H16B<span class="token operator">/</span>go_frontend
├── @babel<span class="token operator">/</span>core@<span class="token number">7.19</span><span class="token number">.3</span>
├── @babel<span class="token operator">/</span>eslint<span class="token operator">-</span>parser@<span class="token number">7.19</span><span class="token number">.1</span>
├── @vue<span class="token operator">/</span>cli<span class="token operator">-</span>plugin<span class="token operator">-</span>babel@<span class="token number">5.0</span><span class="token number">.8</span>
├── @vue<span class="token operator">/</span>cli<span class="token operator">-</span>plugin<span class="token operator">-</span>eslint@<span class="token number">5.0</span><span class="token number">.8</span>
├── @vue<span class="token operator">/</span>cli<span class="token operator">-</span>service@<span class="token number">5.0</span><span class="token number">.8</span>
├── async@<span class="token number">3.2</span><span class="token number">.4</span>
├── axios@<span class="token number">0.27</span><span class="token number">.2</span>
├── core<span class="token operator">-</span>js@<span class="token number">3.25</span><span class="token number">.3</span>
├── echarts@<span class="token number">5.4</span><span class="token number">.1</span>
├── element<span class="token operator">-</span>ui@<span class="token number">2.15</span><span class="token number">.10</span>
├── eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>vue@<span class="token number">8.7</span><span class="token number">.1</span>
├── eslint@<span class="token number">7.32</span><span class="token number">.0</span>
├── qs@<span class="token number">6.11</span><span class="token number">.0</span>
├── router@<span class="token number">1.3</span><span class="token number">.7</span>
├── vue<span class="token operator">-</span>axios@<span class="token number">3.4</span><span class="token number">.1</span>
├── vue<span class="token operator">-</span>router@<span class="token number">3.5</span><span class="token number">.1</span>
├── vue<span class="token operator">-</span>template<span class="token operator">-</span>compiler@<span class="token number">2.7</span><span class="token number">.10</span>
├── vue@<span class="token number">2.7</span><span class="token number">.10</span>
├── vuex@<span class="token number">3.6</span><span class="token number">.2</span>
└── wowjs@<span class="token number">1.1</span><span class="token number">.3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="1-2-2-服务器端"><a href="#1-2-2-服务器端" class="headerlink" title="1.2.2 服务器端"></a>1.2.2 服务器端</h3><ul>
<li><p><strong>开发语言</strong>：Python</p>
<p>依赖包 </p>
  <pre class="line-numbers language-none"><code class="language-none">PyJWT==2.5.0
PyMySQL==1.0.2
Django==4.1.1
django-cors-headers==3.13.0
django-rest-framework==0.1.0
djangorestframework==3.13.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>Web 开发框架</strong>：Django@4.1.1</p>
</li>
<li><p><strong>DBMS</strong>：MySQL</p>
</li>
</ul>
<h2 id="1-3-功能结构"><a href="#1-3-功能结构" class="headerlink" title="1.3 功能结构"></a>1.3 功能结构</h2><p>功能架构示意图如下：</p>
<p><img src="/posts/c89ebf90/功能架构.png" alt=""></p>
<h3 id="1-3-1-登录注册"><a href="#1-3-1-登录注册" class="headerlink" title="1.3.1 登录注册"></a>1.3.1 登录注册</h3><ul>
<li>登录：可以通过输入邮箱和邮箱对应的正确密码，登录进入功能界面，否则会无法进入功能页面。</li>
<li>注册：通过选择用户类型，输入邮箱和密码，当后台查验无误的时候，即可注册账户。</li>
<li>登出：用户登录后可以选择登出，用户会失去访问所有功能界面的权限。</li>
<li>修改密码：在登录后可以选择修改密码，用户的密码会被设置成新的密码。。</li>
</ul>
<h3 id="1-3-2-体育课程"><a href="#1-3-2-体育课程" class="headerlink" title="1.3.2 体育课程"></a>1.3.2 体育课程</h3><p><strong>课程详情</strong>：</p>
<ul>
<li>信息查阅：包括可以查询教师姓名、上课时间、上课地点、课程编号。</li>
<li>公告查阅：可以查询当前课程发布的所有公告。</li>
</ul>
<p><strong>作业详情</strong>：</p>
<ul>
<li>课程进度：以瀑布流的形式展示每个学生面对的所有作业。</li>
<li>作业上传：可以上传自己的作业</li>
</ul>
<p><strong>作业收取</strong>：</p>
<ul>
<li>选择作业：指定作业的内容</li>
<li>完成学生列表展示：应该根据选择器的结果，可以展示学生信息。</li>
<li>未完成学生列表展示：应该根据选择器的结果，可以展示学生信息。</li>
<li>单独作业下载按钮：可以下载某个作业。</li>
<li>全部下载：就是把左右的作业打包成一个 <code>zip</code> 下载。</li>
<li>提交预览：可以在线预览</li>
</ul>
<p><strong>班级管理</strong>：</p>
<ul>
<li>查阅班级：会显示自己管理的所有班级，并且可以查看该班级的学生的具体信息，对学生进行一定的操作。</li>
<li>创建班级：可以创建一个新的班级。</li>
<li>发布通告：可以给具体班级发布通告。</li>
</ul>
<h3 id="1-3-3-体育活动"><a href="#1-3-3-体育活动" class="headerlink" title="1.3.3 体育活动"></a>1.3.3 体育活动</h3><p><strong>活动中心</strong>：</p>
<ul>
<li>活动展示：可以展示活动的简略信息和活动图片，点击活动可以查看具体的活动信息。</li>
<li>活动筛选：可以通过地点、标签、开始时间、结束时间筛选活动。</li>
<li>活动推荐：可以从“最热”、“最新”、“志同道合”、“猜你喜欢”、“最多 TD” 等多个维度对活动进行推荐。</li>
<li>活动创建：可以创建活动。</li>
</ul>
<p><strong>活动信息</strong>：</p>
<ul>
<li>信息展示：可以展示活动的具体信息，比基本信息多了活动的参与人数和活动介绍。</li>
<li>参加活动：可以参加当前活动。</li>
<li>相似活动：可以根据当前活动推荐相似的活动。</li>
</ul>
<p><strong>我的活动</strong>：</p>
<ul>
<li>活动筛选：可以根据学期筛选自己的活动。</li>
<li>活动详情：列表展示活动的基本信息，同时可以跳转到活动的具体页面。</li>
<li>退出活动：可以退出想要选定的活动。</li>
<li>奖励统计：统计活动的总奖励数。</li>
<li>类型饼状图：用饼状图显示参加活动的各种信息。</li>
</ul>
<h3 id="1-3-4-个人信息"><a href="#1-3-4-个人信息" class="headerlink" title="1.3.4 个人信息"></a>1.3.4 个人信息</h3><p><strong>体育锻炼</strong>：</p>
<ul>
<li>TD 统计：可以获得各个学期的 TD 统计信息。</li>
<li>活动推荐：可以推荐适合加 TD 的活动。</li>
</ul>
<p><strong>体测成绩</strong>：</p>
<ul>
<li>成绩表格：可以展示每一项成绩的表格。</li>
<li>成绩排行：对于“50m”、“耐力”、“立定跳远”的成绩进行了排行。</li>
</ul>
<h3 id="1-3-5-管理端"><a href="#1-3-5-管理端" class="headerlink" title="1.3.5 管理端"></a>1.3.5 管理端</h3><p><strong>课程信息</strong>：</p>
<ul>
<li>增删改查课程信息。</li>
<li>增删改查“学生-课程”关系。</li>
</ul>
<p><strong>学生信息</strong>：</p>
<ul>
<li>增删改查学生信息。</li>
</ul>
<hr>
<h1 id="二、数据基本表的定义"><a href="#二、数据基本表的定义" class="headerlink" title="二、数据基本表的定义"></a>二、数据基本表的定义</h1><p>数据库共包含 7 个实体，12 张表，采用 Django 提供的数据库访问接口实现数据库表的定义以及访问，相比于直接使用 SQL 语句更加清晰并且易于维护。每个表对应一个模型类，类中的属性对应表的列。</p>
<p>具体定义以及实现代码如下。</p>
<h2 id="2-1-用户管理部分"><a href="#2-1-用户管理部分" class="headerlink" title="2.1 用户管理部分"></a>2.1 用户管理部分</h2><p>这部分内容关于用户的管理，主要包括用户的登录、注册、修改密码等。该系统中用户有两种，分别为老师和学生，由于老师和学生具有某些共同的性质（例如账号和密码），但是学生具有老师不具备的性质（例如入学年份），因此可以让老师和学生都继承 Django 模型的一个抽象类 <code>AbstractUser</code>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AbstractUser</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>EMAIL_LEN<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'email'</span><span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>NAME_LEN<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'姓名'</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>PASSWD_LEM<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'密码'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        abstract <span class="token operator">=</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这种特化关系表现在数据库的表中是老师表和学生表都具有 <code>email, name</code> 等属性，这里相当于 Django 框架对数据库的表进行了一层抽象。</p>
<h3 id="2-1-1-学生表"><a href="#2-1-1-学生表" class="headerlink" title="2.1.1 学生表"></a>2.1.1 学生表</h3><p>tb_students</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>email</td>
<td>varchar(30)</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td></td>
<td>邮箱</td>
</tr>
<tr>
<td>name</td>
<td>varchar(10)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>姓名</td>
</tr>
<tr>
<td>password</td>
<td>varchar(20)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>密码</td>
</tr>
<tr>
<td>student_id</td>
<td>varchar(8)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>学生编号</td>
</tr>
<tr>
<td>grade</td>
<td>int</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>入学年份</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>AbstractUser<span class="token punctuation">)</span><span class="token punctuation">:</span>
    student_id <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>STUDENT_ID_LEN<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'学号'</span><span class="token punctuation">)</span>
    grade <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">'年级'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_students'</span>  <span class="token comment"># 指明数据库表名</span>
        verbose_name <span class="token operator">=</span> <span class="token string">'学生'</span>  <span class="token comment"># 在admin站点中显示的名称</span>
        verbose_name_plural <span class="token operator">=</span> verbose_name  <span class="token comment"># 显示的复数名称</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""定义每个数据对象的显示信息"""</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>email<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-1-2-教师表"><a href="#2-1-2-教师表" class="headerlink" title="2.1.2 教师表"></a>2.1.2 教师表</h3><p>tb_teachers</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>email</td>
<td>varchar(30)</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td></td>
<td>邮箱</td>
</tr>
<tr>
<td>name</td>
<td>varchar(10)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>姓名</td>
</tr>
<tr>
<td>password</td>
<td>varchar(20)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>密码</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span>AbstractUser<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_teachers'</span>  <span class="token comment"># 指明数据库表名</span>
        verbose_name <span class="token operator">=</span> <span class="token string">'教师'</span>  <span class="token comment"># 在admin站点中显示的名称</span>
        verbose_name_plural <span class="token operator">=</span> verbose_name  <span class="token comment"># 显示的复数名称</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""定义每个数据对象的显示信息"""</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>email<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="2-2-课程管理系统部分"><a href="#2-2-课程管理系统部分" class="headerlink" title="2.2 课程管理系统部分"></a>2.2 课程管理系统部分</h2><p>这部分的表主要设计项目中课程管理相关内容，包括教师发布和删除通知，收发作业，学生选课和提交作业、获取通知。</p>
<h3 id="2-2-1-课程表"><a href="#2-2-1-课程表" class="headerlink" title="2.2.1 课程表"></a>2.2.1 课程表</h3><p>tb_courses</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td>自动递增</td>
<td>课程编号</td>
</tr>
<tr>
<td>name</td>
<td>varchar(40)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>课程名称</td>
</tr>
<tr>
<td>time</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>上课时间</td>
</tr>
<tr>
<td>location</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>上课地点</td>
</tr>
<tr>
<td>manager_email_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td>tb_teacher</td>
<td></td>
<td>课程负责人邮箱</td>
</tr>
<tr>
<td>semester</td>
<td>int</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>课程开设学期（春/秋）</td>
</tr>
<tr>
<td>year</td>
<td>int</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>课程开设学年</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Course</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>COURSE_NAME_LEN<span class="token punctuation">)</span>
    manager_email <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Teacher<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'课程负责人'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'ems'</span><span class="token punctuation">)</span>
    time <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'上课时间'</span><span class="token punctuation">)</span>
    location <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'上课地点'</span><span class="token punctuation">)</span>
    year <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">'年份'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">2022</span><span class="token punctuation">)</span>
    semester <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">'学期'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 1:秋季学期 2:春季学期</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_courses'</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">id</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-2-学生-课程表"><a href="#2-2-2-学生-课程表" class="headerlink" title="2.2.2 学生-课程表"></a>2.2.2 学生-课程表</h3><p>tb_student_course</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>c_id_id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td>tb_courses</td>
<td></td>
<td>课程编号</td>
</tr>
<tr>
<td>s_email_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td>YES</td>
<td>tb_students</td>
<td></td>
<td>学生编号</td>
</tr>
<tr>
<td>grade</td>
<td>int</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>成绩</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">StudentCourse</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s_email <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Student<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    c_id <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Course<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    grade <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">'成绩'</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_student_course'</span>
        unique_together <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"s_email"</span><span class="token punctuation">,</span> <span class="token string">"c_id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-3-教师-课程表"><a href="#2-2-3-教师-课程表" class="headerlink" title="2.2.3 教师-课程表"></a>2.2.3 教师-课程表</h3><p>tb_teacher_course</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>c_id_id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td>tb_courses</td>
<td></td>
<td>课程编号</td>
</tr>
<tr>
<td>t_email_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td>YES</td>
<td>tb_teachers</td>
<td></td>
<td>老师编号</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">TeacherCourse</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    t_email <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Teacher<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    c_id <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Course<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_teacher_course'</span>
        unique_together <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"t_email"</span><span class="token punctuation">,</span> <span class="token string">"c_id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-4-作业表"><a href="#2-2-4-作业表" class="headerlink" title="2.2.4 作业表"></a>2.2.4 作业表</h3><p>tb_homeworks</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td>自动递增</td>
<td>作业编号</td>
</tr>
<tr>
<td>ddl</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>作业截止日期</td>
</tr>
<tr>
<td>content</td>
<td>varchar(300)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>作业内容</td>
</tr>
<tr>
<td>author_email_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td>tb_teachers</td>
<td></td>
<td>作业发布者</td>
</tr>
<tr>
<td>course_id_id</td>
<td>bigint</td>
<td>NO</td>
<td></td>
<td>tb_courses</td>
<td></td>
<td>作业对应的课程</td>
</tr>
<tr>
<td>time</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>作业创建时间</td>
</tr>
<tr>
<td>title</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>作业标题</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Homework</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'作业标题'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    ddl <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>HW_CONTENT_LEN<span class="token punctuation">)</span>
    author_email <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Teacher<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    course_id <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Course<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_homeworks'</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">id</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-5-作业提交表"><a href="#2-2-5-作业提交表" class="headerlink" title="2.2.5 作业提交表"></a>2.2.5 作业提交表</h3><p>tb_hw_submission</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>作业提交时间</td>
</tr>
<tr>
<td>fileTitle</td>
<td>varchar(100)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>文件名称</td>
</tr>
<tr>
<td>fileContent</td>
<td>varchar(100)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>文件所在地址</td>
</tr>
<tr>
<td>homeworkId_id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td>tb_homeworks</td>
<td></td>
<td>作业编号</td>
</tr>
<tr>
<td>submitterEmail_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td>YES</td>
<td>b_students</td>
<td></td>
<td>提交者邮箱</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">HwSubmission</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    fileTitle <span class="token operator">=</span> models<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    fileContent <span class="token operator">=</span> models<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span>upload_to<span class="token operator">=</span><span class="token string">'upload_files'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>
    submitterEmail <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Student<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    homeworkId <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Homework<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_hw_submission'</span>
        unique_together <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"homeworkId"</span><span class="token punctuation">,</span> <span class="token string">"submitterEmail"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>fileTitle<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-2-6-通知表"><a href="#2-2-6-通知表" class="headerlink" title="2.2.6 通知表"></a>2.2.6 通知表</h3><p>tb_notices</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td>自动递增</td>
<td>通知编号</td>
</tr>
<tr>
<td>time</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>通知时间</td>
</tr>
<tr>
<td>content</td>
<td>varchar(1000)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>通知内容</td>
</tr>
<tr>
<td>title</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>通知标题</td>
</tr>
<tr>
<td>author_email_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td>tb_teachers</td>
<td></td>
<td>通知发布者</td>
</tr>
<tr>
<td>course_id_id</td>
<td>bigint</td>
<td>NO</td>
<td></td>
<td>tb_courses</td>
<td></td>
<td>通知对应的课程</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>NOTICE_LEN<span class="token punctuation">)</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    author_email <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Teacher<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    course_id <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Course<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_notices'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="2-3-活动管理部分"><a href="#2-3-活动管理部分" class="headerlink" title="2.3 活动管理部分"></a>2.3 活动管理部分</h2><h3 id="2-3-1-活动表"><a href="#2-3-1-活动表" class="headerlink" title="2.3.1 活动表"></a>2.3.1 活动表</h3><p>tb_activites</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td>自动递增</td>
<td>活动编号</td>
</tr>
<tr>
<td>content</td>
<td>varchar(1000)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动内容</td>
</tr>
<tr>
<td>title</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动标题</td>
</tr>
<tr>
<td>position</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动地点</td>
</tr>
<tr>
<td>create_time</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动创建时间</td>
</tr>
<tr>
<td>start_time</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动结束时间</td>
</tr>
<tr>
<td>author_email</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动创建者邮箱</td>
</tr>
<tr>
<td>tag</td>
<td>varchar(30)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动标签</td>
</tr>
<tr>
<td>TD</td>
<td>int</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动加的TD数量</td>
</tr>
<tr>
<td>img_id</td>
<td>bigint</td>
<td>YES</td>
<td></td>
<td>tb_images</td>
<td></td>
<td>活动图片</td>
</tr>
<tr>
<td>BY</td>
<td>int</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动加的博雅数量</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Activity</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    content <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>NOTICE_LEN<span class="token punctuation">)</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    position <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    create_time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    start_time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    end_time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    author_email <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span>EMAIL_LEN<span class="token punctuation">)</span>
    tag <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    TD <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    BY <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    img <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Images<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_activities'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-3-2-学生-活动表"><a href="#2-3-2-学生-活动表" class="headerlink" title="2.3.2 学生-活动表"></a>2.3.2 学生-活动表</h3><p>tb_student_sctivites</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>datetime(6)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>活动参与时间</td>
</tr>
<tr>
<td>status</td>
<td>varchar(2)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>参与状态（未开始/已完成/已过期）</td>
</tr>
<tr>
<td>activity_id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td>tb_activities</td>
<td></td>
<td>活动编号</td>
</tr>
<tr>
<td>student_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td>YES</td>
<td>tb_students</td>
<td></td>
<td>学生编号</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">StudentActivity</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    student <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Student<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    activity <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Activity<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Status</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>TextChoices<span class="token punctuation">)</span><span class="token punctuation">:</span>
        NOT_START <span class="token operator">=</span> <span class="token string">'NS'</span><span class="token punctuation">,</span> _<span class="token punctuation">(</span><span class="token string">'Not Start'</span><span class="token punctuation">)</span>
        NOT_ATTEND <span class="token operator">=</span> <span class="token string">'NA'</span><span class="token punctuation">,</span> _<span class="token punctuation">(</span><span class="token string">'Not Attend'</span><span class="token punctuation">)</span>
        ATTEND <span class="token operator">=</span> <span class="token string">'A'</span><span class="token punctuation">,</span> _<span class="token punctuation">(</span><span class="token string">'Attend'</span><span class="token punctuation">)</span>

    status <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>
        max_length<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
        choices<span class="token operator">=</span>Status<span class="token punctuation">.</span>choices<span class="token punctuation">,</span>
        default<span class="token operator">=</span>Status<span class="token punctuation">.</span>NOT_START
    <span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_student_activity'</span>
        unique_together <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">,</span> <span class="token string">"activity"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="2-4-个人信息部分"><a href="#2-4-个人信息部分" class="headerlink" title="2.4 个人信息部分"></a>2.4 个人信息部分</h2><h3 id="2-4-1-学生-体测成绩表"><a href="#2-4-1-学生-体测成绩表" class="headerlink" title="2.4.1 学生-体测成绩表"></a>2.4.1 学生-体测成绩表</h3><p>tb_student_examine_result</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>year</td>
<td>int</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td></td>
<td>学年</td>
</tr>
<tr>
<td>tdSpring</td>
<td>int</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>春季 td</td>
</tr>
<tr>
<td>tdAutumn</td>
<td>int</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>秋季 td</td>
</tr>
<tr>
<td>examineResult</td>
<td>varchar(200)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>体测结果</td>
</tr>
<tr>
<td>student_id</td>
<td>varchar(30)</td>
<td>NO</td>
<td>YES</td>
<td>tb_students</td>
<td></td>
<td>学生</td>
</tr>
<tr>
<td>byAutumn</td>
<td>int</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>秋季博雅</td>
</tr>
<tr>
<td>bySpring</td>
<td>int</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>春季博雅</td>
</tr>
<tr>
<td>height</td>
<td>double</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>学生身高</td>
</tr>
<tr>
<td>score</td>
<td>int</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>学生体测分数</td>
</tr>
<tr>
<td>weight</td>
<td>double</td>
<td>YES</td>
<td></td>
<td></td>
<td></td>
<td>学生体重</td>
</tr>
</tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">StudentExamineResult</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    student <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Student<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    year <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tdSpring <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    tdAutumn <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    bySpring <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    byAutumn <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment"># json 格式存储体测成绩信息</span>
    examineResult <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    weight <span class="token operator">=</span> models<span class="token punctuation">.</span>FloatField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">60.1</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    height <span class="token operator">=</span> models<span class="token punctuation">.</span>FloatField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">172.3</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    score <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">85</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        db_table <span class="token operator">=</span> <span class="token string">'tb_student_examine_result'</span>
        unique_together <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">,</span> <span class="token string">"year"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="2-5-其他"><a href="#2-5-其他" class="headerlink" title="2.5 其他"></a>2.5 其他</h2><h3 id="2-5-1-图片管理表"><a href="#2-5-1-图片管理表" class="headerlink" title="2.5.1 图片管理表"></a>2.5.1 图片管理表</h3><p>tb_images</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>可否为空</th>
<th>主码</th>
<th>外码</th>
<th>其他</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>NO</td>
<td>YES</td>
<td></td>
<td>自动递增</td>
<td>图片编号</td>
</tr>
<tr>
<td>img</td>
<td>varchar(100)</td>
<td>NO</td>
<td></td>
<td></td>
<td></td>
<td>图片存储位置</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h1 id="三、系统重要功能实现方法"><a href="#三、系统重要功能实现方法" class="headerlink" title="三、系统重要功能实现方法"></a>三、系统重要功能实现方法</h1><h2 id="3-1-鉴权实现"><a href="#3-1-鉴权实现" class="headerlink" title="3.1 鉴权实现"></a>3.1 鉴权实现</h2><h3 id="3-1-1-token机制"><a href="#3-1-1-token机制" class="headerlink" title="3.1.1 token机制"></a>3.1.1 token机制</h3><p>为了鉴别用户身份，我们采用 token 唯一标识。用户登录后，服务器校验用户身份并返回一个 token；客户端在 session 中储存该 token，并在随后的每一次请求中再请求头中附带该 token，以示身份；最终，服务器校验 token 进而返回数据。</p>
<p>除此之外，token 还可以作为标识用户是否登录的载体，因为只有登录过的用户，才会获得其独一无二的 token。</p>
<h3 id="3-1-2-路由守护"><a href="#3-1-2-路由守护" class="headerlink" title="3.1.2 路由守护"></a>3.1.2 路由守护</h3><p>为了防止用户未登录直接通过网址访问个人中心页等等，我们设置网页的全局路由守卫。此处的逻辑采用前置守卫，即在进入每个页面前检测用户是否登录，从而显示给用户正确的内容。</p>
<p>对于登录注册网页这些显然不需要登录的页面，我们将其路径存储到“白名单”中，即用户的确无需登录即可访问。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> whiteRoute <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'/register'</span><span class="token punctuation">,</span> <span class="token string">'/password'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>对于其余页面，只需在 route 路由文件中设置其 meta 路由元信息，将其中 needLogin 属性置为 true。触发前置路由时，会首先检测当前页面是否在白名单中，如果在则正常显示，否则判断其 needLogin 属性是否为 true，如果为 true，则直接路由到登录界面，以提醒用户需要先登录才能访问当前页面。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> token <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"token"</span><span class="token punctuation">)</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>whiteRoute<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/password'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> hasRegistered <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"registered"</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hasRegistered<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>needLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-2-推荐算法"><a href="#3-2-推荐算法" class="headerlink" title="3.2 推荐算法"></a>3.2 推荐算法</h2><p>  数据挖掘是数据库中数据的另一种应用形式，我们可以从大量收集到的用户行为数据中收集信息，从而对用户进行分析，为用户提供更加个性化的推荐。GO 在活动查看功能部分使用了推荐算法，“猜你喜欢”选项根据用户以往参与活动的记录，为用户推荐更加符合其兴趣的活动。“志同道合”选项可以分析多个用户的参与活动信息，推荐用户可能会感兴趣的活动。</p>
<p>  “猜你喜欢”选项是一个评价问题，随机选取该用户最近几次参加的活动，对于用户未参与的各项活动，分别比较它们和已参加活动的相似程度，按照相似程度进行排序，排名靠前的就是可能和用户喜好比较相符的活动。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">computeWeight</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> activityList<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    Args:
        i: 活动
        activityList: 用户参加过的活动

    Returns: 活动 i 和用户参加过的活动的相似程度
    '''</span>
    w <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> activityList<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'position'</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">.</span>position<span class="token punctuation">:</span>
            w <span class="token operator">+=</span> <span class="token number">7</span>
        <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'tag'</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">.</span>tag<span class="token punctuation">:</span>
            w <span class="token operator">+=</span> <span class="token number">3</span>
        <span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">.</span>title<span class="token punctuation">:</span>
            w <span class="token operator">+=</span> <span class="token number">11</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            w <span class="token operator">+=</span> <span class="token number">8</span> <span class="token operator">*</span> difflib<span class="token punctuation">.</span>SequenceMatcher<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>title<span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>quick_ratio<span class="token punctuation">(</span><span class="token punctuation">)</span>
        w <span class="token operator">+=</span> i<span class="token punctuation">[</span><span class="token string">'TD'</span><span class="token punctuation">]</span> <span class="token operator">+</span> i<span class="token punctuation">[</span><span class="token string">'BY'</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> w<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>  “志同道合” 推荐部分采用了聚类算法，将用户参与的活动信息（包括活动名称，活动地点，活动标签，TD 等）标准化和归一化，对这些向量用 k-means 方法进行聚类分析，得到与该用户兴趣相似的用户，并向其推荐兴趣相似的用户参与的活动，达到“志同道合”的效果。一下是 k-means 推荐算法的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">KMeans</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> k<span class="token punctuation">,</span> distance_func<span class="token operator">=</span>euclidean_distance<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''根据k-means算法求解聚类的中心'''</span>
    m <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 获得行数m</span>
    cluster_assment <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 初始化一个矩阵，用来记录簇索引和存储距离平方</span>
    centroids <span class="token operator">=</span> get_centroids<span class="token punctuation">(</span>data<span class="token punctuation">,</span> k<span class="token punctuation">)</span>  <span class="token comment"># 生成初始化点</span>
    cluster_changed <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># 判断是否需要重新计算聚类中心</span>
    <span class="token keyword">while</span> cluster_changed<span class="token punctuation">:</span>
        cluster_changed <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
            distance_min <span class="token operator">=</span> np<span class="token punctuation">.</span>inf  <span class="token comment"># 设置样本与聚类中心之间的最小的距离，初始值为正无穷</span>
            index_min <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token comment"># 所属的类别</span>
            <span class="token comment"># 判断离哪个类别最近</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
                distance_ji <span class="token operator">=</span> distance_func<span class="token punctuation">(</span>centroids<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> distance_ji <span class="token operator">&lt;</span> distance_min<span class="token punctuation">:</span>
                    distance_min <span class="token operator">=</span> distance_ji
                    index_min <span class="token operator">=</span> j
            <span class="token keyword">if</span> cluster_assment<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> index_min<span class="token punctuation">:</span>
                cluster_changed <span class="token operator">=</span> <span class="token boolean">True</span>
                cluster_assment<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> index_min<span class="token punctuation">,</span> distance_min <span class="token operator">**</span> <span class="token number">2</span>  <span class="token comment"># 存储距离平方</span>
        <span class="token keyword">for</span> cent <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 更新质心，将每个族中的点的均值作为质心</span>
            pts_in_cluster <span class="token operator">=</span> data<span class="token punctuation">[</span>np<span class="token punctuation">.</span>nonzero<span class="token punctuation">(</span>cluster_assment<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>A <span class="token operator">==</span> cent<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            centroids<span class="token punctuation">[</span>cent<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>pts_in_cluster<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> centroids<span class="token punctuation">,</span> cluster_assment

<span class="token keyword">def</span> <span class="token function">nearest</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> cluster_centers<span class="token punctuation">,</span> distance_func<span class="token operator">=</span>euclidean_distance<span class="token punctuation">)</span><span class="token punctuation">:</span>
    min_dist <span class="token operator">=</span> np<span class="token punctuation">.</span>inf
    m <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>cluster_centers<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 当前已经初始化的聚类中心的个数</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> distance_func<span class="token punctuation">(</span>data<span class="token punctuation">,</span> cluster_centers<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 计算point与每个聚类中心之间的距离</span>
        <span class="token keyword">if</span> min_dist <span class="token operator">&gt;</span> d<span class="token punctuation">:</span>  <span class="token comment"># 选择最短距离</span>
            min_dist <span class="token operator">=</span> d
    <span class="token keyword">return</span> min_dist

<span class="token keyword">def</span> <span class="token function">get_centroids</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> k<span class="token punctuation">,</span> distance_func<span class="token operator">=</span>euclidean_distance<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    cluster_centers <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    index <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span> 
    cluster_centers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>data<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span> 
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        sum_all <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
            d<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> nearest<span class="token punctuation">(</span>data<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> cluster_centers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> distance_func<span class="token punctuation">)</span> 
            sum_all <span class="token operator">+=</span> d<span class="token punctuation">[</span>j<span class="token punctuation">]</span> 
        sum_all <span class="token operator">*=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> j<span class="token punctuation">,</span> di <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span> 
            sum_all <span class="token operator">-=</span> di
            <span class="token keyword">if</span> sum_all <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            cluster_centers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>data<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> cluster_centers<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-3-文件上传"><a href="#3-3-文件上传" class="headerlink" title="3.3 文件上传"></a>3.3 文件上传</h2><p>vue中，文件上传需要以 FormData 的结构发送给后端。即</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'homework'</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>如果还需要传入其他数据，则将其他数据一并包含在 formData 中，在最终向后端发包时，将 formData 作为参数整体传递即可。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          url<span class="token operator">:</span> url<span class="token punctuation">,</span>
          method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
          data<span class="token operator">:</span> formData<span class="token punctuation">,</span>
          headers<span class="token operator">:</span> <span class="token punctuation">{</span>
            token<span class="token operator">:</span> token
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-4-图床"><a href="#3-4-图床" class="headerlink" title="3.4 图床"></a>3.4 图床</h2><p>由于在活动界面需要展示每个活动对应的图片，而图片是需要在用户创建活动的时候上传的，所以我们需要将这些图片存在一个位置然后在需要的时候读取。为了更加灵活，我们采用自己租用的服务器 + Nginx 搭建了一个图床，访问对应地址，就能看到相应的图片。在前端需要显示图片的时候后端只需要向前端传递图片的地址，前端访问这个地址就能得到图片，相比于后端向前端直接传图片，这样提高了网站的加载速度。</p>
<p><img src="/posts/c89ebf90/image-20221221135549266.png" alt="image-20221221135549266" style="zoom:67%;"></p>
<h2 id="3-5-动态路由匹配"><a href="#3-5-动态路由匹配" class="headerlink" title="3.5 动态路由匹配"></a>3.5 动态路由匹配</h2><p>我们经常需要把某种模式匹配到的所有路由，全都映射到同个组件。例如，在 Go 走马中，我们有一个 <code>ActivityInfo</code> 组件，对于所有 ID 各不相同的用户，都要使用这个组件来渲染。那么，我们可以在 <code>vue-router</code> 的路由路径中使用“动态路径参数“(dynamic segment) 来达到这个效果，具体设置如下</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/activity_home/activity/:id'</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">'Activity'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/activity/ActivityInfo'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                    needLogin<span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>对于具体的 <code>/activity_home/activity/1</code> 和 <code>/activity_home/activity/514</code> 都可以匹配到这个路由，对应的值都会设置到 <code>$route.params</code> 中，可以直接取出来使用，如图所示：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> activityId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>最终效果如图所示：</p>
<p><img src="/posts/c89ebf90/image-20221221231316744.png" alt="image-20221221231316744" style="zoom:80%;"></p>
<h2 id="3-6-触发器"><a href="#3-6-触发器" class="headerlink" title="3.6 触发器"></a>3.6 触发器</h2><p>   采用触发器来防止异常数据的产生。在插入或删除数据的时候进行检查或者修改，保证数据的完整性。</p>
<p><strong>1. 删除学生时的动作</strong></p>
<p>   删除学生时应该删除这个学生的选课记录、活动参与记录、学生的成绩。</p>
   <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> <span class="token punctuation">`</span>delete_student<span class="token punctuation">`</span> BEFORE <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span>student<span class="token punctuation">`</span> <span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token punctuation">`</span>student_course<span class="token punctuation">`</span> <span class="token keyword">WHERE</span> <span class="token punctuation">`</span>student_id<span class="token punctuation">`</span> <span class="token operator">=</span> OLD<span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">;</span>
    <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token punctuation">`</span>student_activity<span class="token punctuation">`</span> <span class="token keyword">WHERE</span> <span class="token punctuation">`</span>student_id<span class="token punctuation">`</span> <span class="token operator">=</span> OLD<span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">;</span>
    <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token punctuation">`</span>student_examine_result<span class="token punctuation">`</span> <span class="token keyword">WHERE</span> <span class="token punctuation">`</span>student_id<span class="token punctuation">`</span> <span class="token operator">=</span> OLD<span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>2. 删除教师时的动作</strong><br>   删除教师的时候应该删除这个教师开设的课程，以及课程相关信息。</p>
   <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> <span class="token punctuation">`</span>delete_teacher<span class="token punctuation">`</span> BEFORE <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span>teacher<span class="token punctuation">`</span> <span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token punctuation">`</span>course<span class="token punctuation">`</span> <span class="token keyword">WHERE</span> <span class="token punctuation">`</span>teacher_id<span class="token punctuation">`</span> <span class="token operator">=</span> OLD<span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>3. 删除课程时的动作</strong><br>   删除课程的时候应该删除选课记录。</p>
   <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> <span class="token punctuation">`</span>delete_course<span class="token punctuation">`</span> BEFORE <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span>course<span class="token punctuation">`</span> <span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token punctuation">`</span>student_course<span class="token punctuation">`</span> <span class="token keyword">WHERE</span> <span class="token punctuation">`</span>course_id<span class="token punctuation">`</span> <span class="token operator">=</span> OLD<span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>4. 删除活动时的动作</strong></p>
<p>  删除活动时应该删除这个活动对应的参与记录。</p>
   <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> <span class="token punctuation">`</span>delete_activity<span class="token punctuation">`</span> BEFORE <span class="token keyword">DELETE</span> <span class="token keyword">ON</span> <span class="token punctuation">`</span>activity<span class="token punctuation">`</span> <span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token punctuation">`</span>student_activity<span class="token punctuation">`</span> <span class="token keyword">WHERE</span> <span class="token punctuation">`</span>activity_id<span class="token punctuation">`</span> <span class="token operator">=</span> OLD<span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-7-存储过程"><a href="#3-7-存储过程" class="headerlink" title="3.7 存储过程"></a>3.7 存储过程</h2><h3 id="3-7-1-用户管理（登录-注册）"><a href="#3-7-1-用户管理（登录-注册）" class="headerlink" title="3.7.1 用户管理（登录/注册）"></a>3.7.1 用户管理（登录/注册）</h3><ol>
<li><p>学生注册</p>
<p><strong>涉及的基本表：</strong> <code>students</code></p>
<p><strong>过程描述：</strong> 检查该账号未注册后，向学生表中插入这个学生的信息。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">StudentRegister</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        student_num <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'student_num'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        grade <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'grade'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> checkEmail<span class="token punctuation">(</span>email<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            s <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                name<span class="token operator">=</span>name<span class="token punctuation">,</span>
                email<span class="token operator">=</span>email<span class="token punctuation">,</span>
                password<span class="token operator">=</span>password<span class="token punctuation">,</span>
                student_id<span class="token operator">=</span>student_num<span class="token punctuation">,</span>
                grade<span class="token operator">=</span>grade
            <span class="token punctuation">)</span>
            s<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>登录</p>
<p><strong>涉及的基本表：</strong> <code>students</code>，<code>teachers</code></p>
<p><strong>过程描述：</strong> 检查该账号是否存在，密码是否正确。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        email <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        value <span class="token operator">=</span> <span class="token number">0</span>
        token <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            item <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
            <span class="token builtin">type</span> <span class="token operator">=</span> UserType<span class="token punctuation">.</span>student<span class="token punctuation">.</span>value
        <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                item <span class="token operator">=</span> Teacher<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
                <span class="token builtin">type</span> <span class="token operator">=</span> UserType<span class="token punctuation">.</span>teacher<span class="token punctuation">.</span>value
            <span class="token keyword">except</span> Teacher<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value <span class="token operator">=</span> <span class="token number">1</span>

        <span class="token keyword">if</span> value <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> password <span class="token operator">!=</span> item<span class="token punctuation">.</span>password<span class="token punctuation">:</span>
                value <span class="token operator">=</span> <span class="token number">2</span>  <span class="token comment"># 密码错误</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                token <span class="token operator">=</span> gen_token<span class="token punctuation">(</span>email<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'token'</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span> <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token builtin">type</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>教师注册</p>
<p><strong>涉及的基本表：</strong> <code>teachers</code><br><strong>过程描述：</strong> 检查该账号未注册后，向教师表中插入这个教师的信息。<br><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">TeacherRegister</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> checkEmail<span class="token punctuation">(</span>email<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            s <span class="token operator">=</span> Teacher<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                name<span class="token operator">=</span>name<span class="token punctuation">,</span>
                email<span class="token operator">=</span>email<span class="token punctuation">,</span>
                password<span class="token operator">=</span>password<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>
            s<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>

            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>密码修改</p>
<p><strong>涉及的基本表：</strong> <code>students</code>，<code>teachers</code></p>
<p><strong>过程描述：</strong> 检查该账号是否存在，密码是否正确，修改密码。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ResetPassword</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> <span class="token string">'token error'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
        new <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'newPass'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        old <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'oldPass'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            item <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
        <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                item <span class="token operator">=</span> Teacher<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
            <span class="token keyword">except</span> Teacher<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'用户不存在'</span>
        <span class="token keyword">if</span> value <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> item<span class="token punctuation">.</span>password <span class="token operator">!=</span> old<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'旧密码错误'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                item<span class="token punctuation">.</span>password <span class="token operator">=</span> new
                item<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-7-2-课程系统"><a href="#3-7-2-课程系统" class="headerlink" title="3.7.2 课程系统"></a>3.7.2 课程系统</h3><h4 id="3-7-2-1-管理员相关"><a href="#3-7-2-1-管理员相关" class="headerlink" title="3.7.2.1 管理员相关"></a>3.7.2.1 管理员相关</h4><ol>
<li><p>添加课程</p>
<p><strong>涉及的基本表：</strong> <code>courses</code>, <code>teacher_course</code></p>
<p><strong>过程描述：</strong> 添加课程到 courses 表中，并且将创建课程的教师和课程添加到教师-课程表中。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AddCourse</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        reason <span class="token operator">=</span> <span class="token string">''</span>
        email <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'major_teacher_email'</span><span class="token punctuation">]</span>
        value <span class="token operator">=</span> <span class="token number">0</span>
        course_id <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            teacher <span class="token operator">=</span> Teacher<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
        <span class="token keyword">except</span> Teacher<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            value <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'教师邮箱不存在'</span>
        <span class="token keyword">if</span> value <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>

            <span class="token keyword">try</span><span class="token punctuation">:</span>
                course <span class="token operator">=</span> Course<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                    name<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    manager_email<span class="token operator">=</span>teacher<span class="token punctuation">,</span>
                    time<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    location<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    year<span class="token operator">=</span>getYearNow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    semester<span class="token operator">=</span>getSemesterNow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
                course_id <span class="token operator">=</span> course<span class="token punctuation">.</span><span class="token builtin">id</span>
                tc <span class="token operator">=</span> TeacherCourse<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                    t_email<span class="token operator">=</span>teacher<span class="token punctuation">,</span>
                    c_id<span class="token operator">=</span>course
                <span class="token punctuation">)</span>
                course<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
                tc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'未知原因'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'course_id'</span><span class="token punctuation">:</span> course_id<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>添加用户到课程</p>
<p><strong>涉及的基本表：</strong> <code>student_course</code></p>
<p><strong>过程描述：</strong> 检查用户是否存在，检查课程是否存在，检查用户是否已经在课程中，添加用户到课程。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AddUserToCourse</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        ret<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        email <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'user_email'</span><span class="token punctuation">]</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'course_id'</span><span class="token punctuation">]</span>
        ys <span class="token operator">=</span> datetime<span class="token punctuation">.</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>month
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            s <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
            c <span class="token operator">=</span> Course<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span>
            old <span class="token operator">=</span> StudentCourse<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>s_email<span class="token operator">=</span>s<span class="token punctuation">)</span>
            <span class="token keyword">if</span> old<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                ret <span class="token operator">=</span> <span class="token number">1</span>
                reason <span class="token operator">=</span> <span class="token string">'该学生已经选过id为{}的{}课了，请退掉再选新的课'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>old<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>c_id<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span> old<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>c_id<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
            sc <span class="token operator">=</span> StudentCourse<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                s_email<span class="token operator">=</span>s<span class="token punctuation">,</span>
                c_id<span class="token operator">=</span>c<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>
            sc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token number">2</span>
            reason <span class="token operator">=</span> <span class="token string">'此邮箱未注册'</span>
        <span class="token keyword">except</span> Course<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>

            ret <span class="token operator">=</span> <span class="token number">3</span>
            reason <span class="token operator">=</span> <span class="token string">'找不到该课程'</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'该用户已加入课程或其他错误'</span>

        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> ret<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>删除课程</p>
<p><strong>涉及的基本表：</strong> <code>courses</code>, <code>teacher_course</code>, <code>student_course</code></p>
<p><strong>过程描述：</strong> 删除课程，删除教师-课程表中的记录，删除学生-课程表中的记录。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">DeleteCourse</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        ret <span class="token operator">=</span> <span class="token number">0</span>
        reason <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            c <span class="token operator">=</span> Course<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'course_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            c<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Course<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'找不到该课程'</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token number">2</span>
            reason <span class="token operator">=</span> <span class="token string">'未知原因'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> ret<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>删除用户的选课记录</p>
<p><strong>涉及的基本表：</strong> <code>student_course</code></p>
<p><strong>过程描述：</strong> 删除学生-课程表中的记录。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">DeleteUserFromCourse</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        ret<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        email <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'user_email'</span><span class="token punctuation">]</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'course_id'</span><span class="token punctuation">]</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            s <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
            c <span class="token operator">=</span> Course<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span>
            obj <span class="token operator">=</span> StudentCourse<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
                s_email<span class="token operator">=</span>s<span class="token punctuation">,</span>
                c_id<span class="token operator">=</span>c
            <span class="token punctuation">)</span>
            obj<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token number">2</span>
            reason <span class="token operator">=</span> <span class="token string">'此邮箱未注册'</span>
        <span class="token keyword">except</span> Course<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>

            ret <span class="token operator">=</span> <span class="token number">3</span>
            reason <span class="token operator">=</span> <span class="token string">'找不到该课程'</span>
        <span class="token keyword">except</span> StudentCourse<span class="token punctuation">.</span>DoesNotExist <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'删除失败，该用户不在课程中'</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'未知原因'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> ret<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>编辑课程</p>
<p><strong>涉及的基本表：</strong> <code>courses</code></p>
<p><strong>过程描述：</strong> 编辑课程。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">EditCourse</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        <span class="token comment"># type = UserType.student if data['type'] == '学生' else UserType.teacher</span>
        value <span class="token operator">=</span> <span class="token number">0</span>
        reason <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            c <span class="token operator">=</span> Course<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            c<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            c<span class="token punctuation">.</span>location <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span>
            c<span class="token punctuation">.</span>time <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span>
            c<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Course<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            value <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'课程不存在'</span>
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            value <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'未知原因'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span>
            <span class="token string">'reason'</span><span class="token punctuation">:</span> reason
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="3-7-2-2-学生相关"><a href="#3-7-2-2-学生相关" class="headerlink" title="3.7.2.2 学生相关"></a>3.7.2.2 学生相关</h4><ol>
<li><p>提交作业</p>
<p><strong>涉及的基本表：</strong> <code>homeworks</code>, <code>hw_submission</code></p>
<p><strong>过程描述：</strong> 检查该学生是否提交过这项作业，如果提交过，删除旧的提交以及旧的文件，然后存储新上传的文件到服务器并将文件名、文件地址保存到数据库。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">SubmitHomework</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        reason<span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'登录超时或者其他原因导致token失效'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            u_email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                user <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>u_email<span class="token punctuation">)</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    homework <span class="token operator">=</span> Homework<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

                    file_obj <span class="token operator">=</span> request<span class="token punctuation">.</span>FILES<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'hw_submit'</span><span class="token punctuation">)</span>
                    oldhws <span class="token operator">=</span> HwSubmission<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>homeworkId<span class="token operator">=</span>homework<span class="token punctuation">,</span> submitterEmail<span class="token operator">=</span>user<span class="token punctuation">)</span>
                    <span class="token keyword">for</span> _ <span class="token keyword">in</span> oldhws<span class="token punctuation">:</span>
                        _<span class="token punctuation">.</span>fileContent<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        _<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    sbm <span class="token operator">=</span> HwSubmission<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                        fileContent<span class="token operator">=</span>file_obj<span class="token punctuation">,</span>
                        fileTitle<span class="token operator">=</span>file_obj<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                        submitterEmail<span class="token operator">=</span>user<span class="token punctuation">,</span>
                        homeworkId<span class="token operator">=</span>homework
                    <span class="token punctuation">)</span>
                    sbm<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">except</span> Homework<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                    value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'要提交的作业不存在'</span>
                <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'未知错误'</span>
            <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'用户不存在'</span>

        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="3-7-2-3-教师相关"><a href="#3-7-2-3-教师相关" class="headerlink" title="3.7.2.3 教师相关"></a>3.7.2.3 教师相关</h4><ol>
<li><p>创建课程</p>
<p><strong>设计的基本表：</strong><code>courses</code></p>
<p> <strong>过程描述：</strong>将课程信息插入到 <code>course</code> 表中。</p>
<p> <strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">CreateCourse</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        id_ <span class="token operator">=</span> <span class="token boolean">None</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'登录超时或者其他原因导致token失效'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            u_email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                c <span class="token operator">=</span> Course<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                    name<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    location<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    time<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    manager_email_id<span class="token operator">=</span>u_email<span class="token punctuation">,</span>
                    year<span class="token operator">=</span>getYearNow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    semester<span class="token operator">=</span>getSemesterNow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
                c<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
                id_ <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token builtin">id</span>
                tc <span class="token operator">=</span> TeacherCourse<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                    t_email<span class="token operator">=</span>Teacher<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>u_email<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    c_id<span class="token operator">=</span>c
                <span class="token punctuation">)</span>
                tc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Teacher<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'用户不存在'</span>
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'未知错误'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>id_<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>发布通知</p>
<p><strong>涉及的基本表：</strong><code>notices</code></p>
<p><strong>过程描述：</strong>将这条通知插入到通知表中。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AddNotice</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        id_ <span class="token operator">=</span> <span class="token boolean">None</span>

        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'登录超时或者其他原因导致token失效'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            u_email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                n <span class="token operator">=</span> Notice<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                    content<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    title<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    course_id<span class="token operator">=</span>Course<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'g_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    author_email<span class="token operator">=</span>Teacher<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>u_email<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                n<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
                id_ <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token builtin">id</span>
            <span class="token keyword">except</span> Course<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'课程不存在'</span>
            <span class="token keyword">except</span> Teacher<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'用户不存在'</span>
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'未知错误'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>id_<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>删除通知</p>
<p><strong>涉及的基本表：</strong><code>notices</code></p>
<p><strong>过程描述：</strong>检查这条通知是否存在，并且作者是提出删除请求的用户，如果存在，将这条通知从通知表中删除。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">DeleteNotice</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        <span class="token comment"># token = gen_token('20230002@buaa.edu.cn')</span>
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'登录超时或者其他原因导致token失效'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            u_email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                n <span class="token operator">=</span> Notice<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> n<span class="token punctuation">.</span>author_email<span class="token punctuation">.</span>email <span class="token operator">==</span> u_email<span class="token punctuation">:</span>
                    n<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'无权删除，只能删除自己发表的通知'</span>
                n<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Notice<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'通知不存在'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-7-3-活动系统"><a href="#3-7-3-活动系统" class="headerlink" title="3.7.3 活动系统"></a>3.7.3 活动系统</h3><ol>
<li><p>创建活动</p>
<p><strong>涉及的基本表：</strong><code>activites</code></p>
<p><strong>过程描述：</strong>将这条活动插入到活动表中。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">CreateActivity</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'登录超时或者其他原因导致token失效'</span>
        u_email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkEmail<span class="token punctuation">(</span>u_email<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'用户不存在'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            img_id <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'img_id'</span><span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                img <span class="token operator">=</span> Images<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>img_id<span class="token punctuation">)</span>
            <span class="token keyword">except</span> Images<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                img <span class="token operator">=</span> <span class="token boolean">None</span>

            a <span class="token operator">=</span> Activity<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                title<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                content<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                position<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'position'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                start_time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromisoformat<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'start_time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                end_time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromisoformat<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'end_time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                author_email<span class="token operator">=</span>u_email<span class="token punctuation">,</span>
                tag<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'tag'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                TD<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'TD'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                BY<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'BY'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                img<span class="token operator">=</span>img
            <span class="token punctuation">)</span>
            a<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token builtin">id</span> <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token builtin">id</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token builtin">id</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>参加活动</p>
<p><strong>涉及的基本表：</strong><code>activites</code></p>
<p><strong>过程描述：</strong>检查用户信息和活动信息，如果活动存在，将用户和活动插入到参加活动表中。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">TakePartInActivity</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'登录超时或者其他原因导致token失效'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            u_email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                user <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>u_email<span class="token punctuation">)</span>
                activity <span class="token operator">=</span> Activity<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                StudentActivity<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>student<span class="token operator">=</span>user<span class="token punctuation">,</span> activity<span class="token operator">=</span>activity<span class="token punctuation">)</span>
            <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'用户不存在'</span>
            <span class="token keyword">except</span> Activity<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'活动不存在'</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'未知错误: '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>退出活动</p>
<p><strong>涉及的基本表：</strong><code>activites</code></p>
<p><strong>过程描述：</strong>检查用户信息和活动信息，如果活动存在，并且用户参与了这项活动，将用户和活动从参加活动表中删除。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ExitActivity</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        token <span class="token operator">=</span> get_header_token<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
            value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'登录超时或者其他原因导致token失效'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            u_email <span class="token operator">=</span> decode_token<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                user <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>u_email<span class="token punctuation">)</span>
                activity <span class="token operator">=</span> Activity<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                sa <span class="token operator">=</span> StudentActivity<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>student<span class="token operator">=</span>user<span class="token punctuation">,</span> activity<span class="token operator">=</span>activity<span class="token punctuation">)</span>
                sa<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'用户不存在'</span>
            <span class="token keyword">except</span> Activity<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'活动不存在'</span>
            <span class="token keyword">except</span> StudentActivity<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'用户未参与该活动'</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'未知错误: '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-7-4-管理员系统"><a href="#3-7-4-管理员系统" class="headerlink" title="3.7.4 管理员系统"></a>3.7.4 管理员系统</h3><ol>
<li><p>删除用户</p>
<p><strong>涉及的基本表：</strong><code>students</code>, <code>teachers</code></p>
<p><strong>过程描述：</strong>检查用户信息，如果用户存在，将用户从用户表中删除。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">DeleteUser</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            s <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            s<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            t <span class="token operator">=</span> Teacher<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            t<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Teacher<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            value <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'用户不存在'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>编辑用户</p>
<p><strong>涉及的基本表：</strong><code>students</code>, <code>teachers</code></p>
<p><strong>过程描述：</strong>检查用户信息，如果用户存在，将用户信息更新到用户表中。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">EditUser</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request <span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>data
        value<span class="token punctuation">,</span> reason <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">''</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            s <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            s<span class="token punctuation">.</span>email <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
            s<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            s<span class="token punctuation">.</span>student_id <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'student_num'</span><span class="token punctuation">]</span>
            s<span class="token punctuation">.</span>grade <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
            s<span class="token punctuation">.</span>password <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>
            s<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Student<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            value <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'用户不存在'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>添加用户</p>
<p><strong>设计的基本表：</strong><code>students</code>, <code>teachers</code></p>
<p><strong>过程描述：</strong>检查用户信息，如果用户不存在，将用户信息添加到学生表或者教师表中。</p>
<p><strong>代码：</strong></p>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AddUser</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request <span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

        name <span class="token operator">=</span>  <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span>  <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        student_num <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'student_num'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        grade <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'grade'</span><span class="token punctuation">)</span>
        <span class="token comment"># 前端传来的grade是日期</span>
        grade <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>grade<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        password <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        ret <span class="token operator">=</span> <span class="token number">0</span>
        reason <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">if</span> checkEmail<span class="token punctuation">(</span>email<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token number">1</span>
            reason <span class="token operator">=</span> <span class="token string">'邮箱已注册'</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                s <span class="token operator">=</span> Student<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
                    email<span class="token operator">=</span>email<span class="token punctuation">,</span>
                    name<span class="token operator">=</span>name<span class="token punctuation">,</span>
                    student_id<span class="token operator">=</span>student_num<span class="token punctuation">,</span>
                    grade<span class="token operator">=</span>grade<span class="token punctuation">,</span>
                    password<span class="token operator">=</span>password
                <span class="token punctuation">)</span>
                s<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                ret <span class="token operator">=</span> <span class="token number">2</span>
                reason <span class="token operator">=</span> <span class="token string">'未知原因'</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> ret<span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">:</span> reason<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h1 id="四、系统实现效果"><a href="#四、系统实现效果" class="headerlink" title="四、系统实现效果"></a>四、系统实现效果</h1><h2 id="4-1-登录注册"><a href="#4-1-登录注册" class="headerlink" title="4.1 登录注册"></a>4.1 登录注册</h2><h3 id="4-1-1-首页"><a href="#4-1-1-首页" class="headerlink" title="4.1.1 首页"></a>4.1.1 首页</h3><p><img src="/posts/c89ebf90/image-20221221232351946.png" alt="image-20221221232351946"></p>
<p><strong>信息</strong></p>
<ul>
<li>图标：网站的图标。</li>
<li>口号：网站的口号。</li>
<li>背景：小猫垂钓图。</li>
</ul>
<p><strong>功能</strong></p>
<ul>
<li>登录：点击这个按钮后进入“登录”界面。</li>
<li>注册：点击这个按钮后进入“注册”界面。</li>
</ul>
<h3 id="4-1-2-登录"><a href="#4-1-2-登录" class="headerlink" title="4.1.2 登录"></a>4.1.2 登录</h3><p><img src="/posts/c89ebf90/image-20221221232558406.png" alt="image-20221221232558406"></p>
<p><strong>信息</strong></p>
<ul>
<li>邮箱 prompt</li>
<li>密码 prompt</li>
<li>登录按钮</li>
<li>背景界面为初始界面加一层蒙版</li>
</ul>
<p><strong>功能</strong></p>
<ul>
<li>点击 exit 按钮可以回到初始界面</li>
<li>邮箱和密码的信息按登录按钮后传递给后端，后端检验后返回是否是正确密码</li>
<li>如果是正确密码，就进入主界面（还未实现，意思意思就好了）</li>
<li>如果是错误密码，应当显示错误密码并清空 input 后再次等待</li>
</ul>
<h3 id="4-1-3-注册"><a href="#4-1-3-注册" class="headerlink" title="4.1.3 注册"></a>4.1.3 注册</h3><p>老师注册界面</p>
<p><img src="/posts/c89ebf90/image-20221221232758214.png" alt="image-20221221232758214"></p>
<p>学生注册界面：</p>
<p><img src="/posts/c89ebf90/image-20221221233317411.png" alt="image-20221221233317411"></p>
<p><strong>信息</strong></p>
<ul>
<li>各种 prompt</li>
<li>确认按钮</li>
</ul>
<p><strong>功能</strong></p>
<ul>
<li>按 exit 会退回到初始界面，按 pre 会退回到第一个注册界面。</li>
<li>在第一个界面按“确认“会检测输入内容的合法性，如果合法，则进入第二个界面，如果不合法，则显示提示信息。对于输入内容的合法性：<ul>
<li>学生学号需要不重复</li>
<li>其他的需要非空</li>
</ul>
</li>
<li>输入密码和确认密码（再次输入相同密码）后，需要检验两次是否相同，并将密码登记入数据库。</li>
<li>一切正常后，按“确认”回到初始界面。</li>
<li>根据身份单选框的不同（目前只有老师和学生两种），提供后面不同的选项，比如如果勾选学生，则应该要求用户多输入学号和年级两项内容，而如果勾选老师，则不需要多输入内容。</li>
</ul>
<h3 id="4-1-4-登出"><a href="#4-1-4-登出" class="headerlink" title="4.1.4 登出"></a>4.1.4 登出</h3><p><img src="/posts/c89ebf90/image-20221221233457074.png" alt="image-20221221233457074"></p>
<p><strong>功能</strong></p>
<ul>
<li>点击登出后失去所有的权限，重新回到首页。</li>
</ul>
<h3 id="4-1-5-修改密码"><a href="#4-1-5-修改密码" class="headerlink" title="4.1.5 修改密码"></a>4.1.5 修改密码</h3><p><img src="/posts/c89ebf90/image-20221221234005472.png" alt="image-20221221234005472"></p>
<p><strong>功能</strong>：</p>
<ul>
<li>修改密码，前端提供一定的检测功能。</li>
</ul>
<h2 id="4-2-体育课程"><a href="#4-2-体育课程" class="headerlink" title="4.2 体育课程"></a>4.2 体育课程</h2><h3 id="4-2-1-课程详情"><a href="#4-2-1-课程详情" class="headerlink" title="4.2.1 课程详情"></a>4.2.1 课程详情</h3><p><img src="/posts/c89ebf90/image-20221222001923805.png" alt="image-20221222001923805"></p>
<p><strong>信息</strong></p>
<ul>
<li>课程基本信息中包括：<ul>
<li>课程名称（这个要字体比较大，比较显眼）</li>
<li>老师姓名</li>
<li>上课时间</li>
<li>课程编号</li>
</ul>
</li>
<li>公告栏有多个，其主要内容有<ul>
<li>标题，即公告标题（大一点）</li>
<li>时间期限（稍微大一点）</li>
<li>具体内容</li>
</ul>
</li>
</ul>
<h3 id="4-2-2-作业提交"><a href="#4-2-2-作业提交" class="headerlink" title="4.2.2 作业提交"></a>4.2.2 作业提交</h3><p><strong>展示界面</strong></p>
<p><img src="/posts/c89ebf90/image-20221222002346692.png" alt="image-20221222002346692"></p>
<p><strong>提交作业</strong></p>
<p><img src="/posts/c89ebf90/image-20221222002421520.png" alt="image-20221222002421520"></p>
<p><strong>信息</strong></p>
<ul>
<li>课程进度：当前课程按时间排序的所有作业。</li>
<li>作业标题：就是作业的题目。</li>
<li>作业详情，包括：<ul>
<li>开始时间：年-月-日-时-分</li>
<li>截止时间：年-月-日-时-分</li>
<li>作业详情：类似于补充信息，比如（“允许重复提交，是大作业，算分“之类的）</li>
<li>作业附件：一个下载按钮，可以下载作业附件，就像</li>
</ul>
</li>
<li><p>提交相关：</p>
<ul>
<li>就是在布局右下角的那个东西</li>
<li>提交输入框，就像 CO 的一样</li>
<li>提价按钮，就是上面这幅图靠右的东西</li>
<li><p>提交情况：</p>
<ul>
<li>显示是否成功提交</li>
<li>显示提交的时间</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>功能</strong></p>
<ul>
<li>可以在“课程进度“里选择要提交的作业。</li>
<li>显示作业的信息。</li>
<li>可以下载作业附件。</li>
<li>可以提交作业。</li>
<li>可以查看提交是否成功。</li>
</ul>
<h3 id="4-2-3-作业收取"><a href="#4-2-3-作业收取" class="headerlink" title="4.2.3 作业收取"></a>4.2.3 作业收取</h3><p><img src="/posts/c89ebf90/image-20221221234427928.png" alt="image-20221221234427928"></p>
<p><strong>信息</strong></p>
<ul>
<li>课程选择器的选项：因为一个老师可能同时担任多门课程的，所以选择器需要提供老师所有的课程。</li>
<li>作业批次选择器：对于一个课程，可能留了多次作业，所以需要提供各个作业的名字。</li>
<li>完成学生列表：左侧的那个表格，可以“当前课程当前作业”的完成学生的名单，对于每个学生，显示“学号、姓名、作业文件名”</li>
<li>未提交名单：右侧表格，显示未完成作业的学生的“学号、姓名”</li>
</ul>
<p><strong>功能</strong>：</p>
<ul>
<li>选择特定的某次作业：即两个选择器发挥的功能。</li>
<li>完成学生列表展示：应该根据选择器的结果，可以展示学生信息。</li>
<li>未完成学生列表展示：应该根据选择器的结果，可以展示学生信息。</li>
<li>单独作业下载按钮：可以下载某个作业，比如说图中的 <code>李华</code>。</li>
<li>全部下载：就是把左右的作业打包成一个 <code>zip</code> 下载。</li>
</ul>
<h3 id="4-2-4-班级管理"><a href="#4-2-4-班级管理" class="headerlink" title="4.2.4 班级管理"></a>4.2.4 班级管理</h3><p><strong>浏览界面</strong>：</p>
<p><img src="/posts/c89ebf90/image-20221221234648414.png" alt="image-20221221234648414"></p>
<p><strong>添加活动</strong>：</p>
<p><img src="/posts/c89ebf90/image-20221221234724546.png" alt="image-20221221234724546"></p>
<p><strong>信息</strong>：</p>
<ul>
<li>显示当前用户管理的课程。</li>
<li>课程信息包括：<ul>
<li>课程 ID</li>
<li>上课时间</li>
<li>游泳馆</li>
</ul>
</li>
<li>显示上课学生的基本信息。</li>
<li>“创建课程”按键。</li>
</ul>
<p><strong>功能</strong>：</p>
<ul>
<li>点击“学生详情”可以查看学生的详细内容。</li>
<li>点击“创建班级“可以创建班级。</li>
</ul>
<h2 id="4-3-体育活动"><a href="#4-3-体育活动" class="headerlink" title="4.3 体育活动"></a>4.3 体育活动</h2><h3 id="4-3-1-活动中心"><a href="#4-3-1-活动中心" class="headerlink" title="4.3.1 活动中心"></a>4.3.1 活动中心</h3><p><strong>浏览活动</strong></p>
<p><img src="/posts/c89ebf90/image-20221221235603410.png" alt="image-20221221235603410"></p>
<p><strong>筛选机制</strong></p>
<p><img src="/posts/c89ebf90/image-20221221235714354.png" alt="image-20221221235714354"></p>
<p><strong>推荐机制</strong></p>
<p><img src="/posts/c89ebf90/image-20221221235843792.png" alt="image-20221221235843792"></p>
<p><strong>信息</strong></p>
<ul>
<li>上面 5 个是过滤器<ul>
<li>TD：包括<ul>
<li>最多TD：就是按 TD 排序大小排序</li>
<li>最值TD：按 （TD / （截止日期 - 开始日期））</li>
<li>最多博雅：安好博雅次数排序</li>
</ul>
</li>
<li>推荐：包括<ul>
<li>最热：参加人数最多</li>
<li>最新：开始时间最大</li>
<li>志同道合：推荐身边的人（两个人参加了相同的多个活动）参加的活动。</li>
<li>猜你喜欢：推荐与之前参加过的活动相似的活动。可以给男生推荐女生多的活动，反之亦然。</li>
</ul>
</li>
<li>地点：<ul>
<li>田径场</li>
<li>体育连廊</li>
<li>排球场</li>
<li>篮球场</li>
<li>羽毛球馆</li>
<li>游泳馆</li>
</ul>
</li>
<li>时间：<ul>
<li>开始日期：年-月-日-时（如果 时 太长了，可以考虑去了）</li>
<li>截止日期：年-月-日-时</li>
</ul>
</li>
<li>标签<ul>
<li>社团活动</li>
<li>学院活动</li>
<li>学校活动</li>
<li>个人活动</li>
</ul>
</li>
</ul>
</li>
<li>每个活动占据一个 block，每个 block 的上面是一张活动图片（创建活动的时候可选上传图片，如果没有的话，就选择创建人的头像）下方是活动名称和开始时间，截止时间</li>
<li>每个页面展示 9 个 block，如果多于 9 个 block，那么分页。</li>
<li>创建 + 号浮在 block 上</li>
</ul>
<p><strong>功能</strong></p>
<ul>
<li><p><strong>选择器</strong>：如果啥都不选，那么应该呈现所有活动，如果选了过滤器，应当有叠加效果，比如说我可以看“TD 最多的，最热的，在田径场上的社团活动”。</p>
</li>
<li><p><strong>创建活动</strong>：那个加号可以跳转到创建页面（这里不涉及）</p>
</li>
<li><p>查看活动详情：可以点击 block 看详细信息（也就是跳转到“活动详情”页面，这里也不涉及）</p>
</li>
</ul>
<h3 id="4-3-2-创建活动"><a href="#4-3-2-创建活动" class="headerlink" title="4.3.2 创建活动"></a>4.3.2 创建活动</h3><p><img src="/posts/c89ebf90/image-20221222000308893.png" alt="image-20221222000308893"></p>
<p><strong>功能</strong>：</p>
<ul>
<li>填写相关信息后即可创建活动。</li>
</ul>
<h3 id="4-3-3-活动详情"><a href="#4-3-3-活动详情" class="headerlink" title="4.3.3 活动详情"></a>4.3.3 活动详情</h3><p><strong>活动介绍</strong>：</p>
<p><img src="/posts/c89ebf90/image-20221222000728709.png" alt="image-20221222000728709"></p>
<p><strong>相似活动推荐</strong></p>
<p><img src="/posts/c89ebf90/image-20221222000843237.png" alt="image-20221222000843237"></p>
<p><strong>信息</strong></p>
<ul>
<li>活动图片，需要显示具体的图片</li>
<li>各种信息都需要</li>
<li>活动介绍：这个信息没有在“活动中心”界面显示，需要在这里显示。</li>
<li>相似活动：返回与当前活动“相似”的活动（信息内容与“活动中心”的一致）</li>
</ul>
<p><strong>功能</strong></p>
<ul>
<li>根据当前活动推荐相似活动<ul>
<li>利用一个函数来评价相似性</li>
<li>比如说如果“地点，标签，时间，内容”类似，就被判定为相似活动</li>
<li>相似活动只需要提供 3 个。</li>
</ul>
</li>
</ul>
<h3 id="4-3-4-我的活动"><a href="#4-3-4-我的活动" class="headerlink" title="4.3.4 我的活动"></a>4.3.4 我的活动</h3><p><img src="/posts/c89ebf90/image-20221222002901744.png" alt="image-20221222002901744"></p>
<p><strong>信息</strong></p>
<ul>
<li>学期选择器选择学期</li>
<li>活动列表根据学期选择器选择的学期展示活动，每个活动都有如上条目。</li>
<li>累计 TD，就是个数，累计博雅，也是个数</li>
<li>标签饼状图，刻画所选活动的标签的比例，比如说两个学院活动，一个个人活动，就是 66% 学院活动，33% 个人活动</li>
<li>地点饼状图</li>
</ul>
<p><strong>功能</strong></p>
<p>列表里面有个“操作”条目，对于每个活动，都有如下两个操作</p>
<ul>
<li>查看详情：跳转到具体的活动页面</li>
<li>退出活动：就是退出活动的意思。</li>
</ul>
<h2 id="4-4-个人信息"><a href="#4-4-个人信息" class="headerlink" title="4.4 个人信息"></a>4.4 个人信息</h2><h3 id="4-4-1-体育锻炼"><a href="#4-4-1-体育锻炼" class="headerlink" title="4.4.1 体育锻炼"></a>4.4.1 体育锻炼</h3><p><img src="/posts/c89ebf90/image-20221222003213771.png" alt="image-20221222003213771"></p>
<p><strong>信息</strong></p>
<ul>
<li>上方是一个表单，里面有学年，已得 TD，预期 TD 三项<ul>
<li>已得 TD 指的是在活动截止时间计算的 TD</li>
<li>预期 TD 是活动开始时间计算的 TD</li>
</ul>
</li>
<li>底下是一个 TD 活动推荐</li>
</ul>
<p><strong>功能</strong></p>
<ul>
<li>可以推荐 TD 活动。</li>
</ul>
<h3 id="4-4-2-体测成绩"><a href="#4-4-2-体测成绩" class="headerlink" title="4.4.2 体测成绩"></a>4.4.2 体测成绩</h3><p><strong>体测成绩</strong></p>
<p><img src="/posts/c89ebf90/image-20221222003550614.png" alt="image-20221222003550614"></p>
<p><strong>排行榜</strong></p>
<p><img src="/posts/c89ebf90/image-20221222003608127.png" alt="image-20221222003608127"></p>
<p><strong>信息</strong></p>
<ul>
<li>上面的是体测成绩展示表单，具体的信息参考体测成绩表。</li>
<li>最下方是三个排行榜，排行榜包括排名，姓名，成绩三个表项。</li>
</ul>
<h2 id="4-5-管理端"><a href="#4-5-管理端" class="headerlink" title="4.5 管理端"></a>4.5 管理端</h2><h3 id="4-5-1-课程名单"><a href="#4-5-1-课程名单" class="headerlink" title="4.5.1 课程名单"></a>4.5.1 课程名单</h3><p><img src="/posts/c89ebf90/image-20221222001339919.png" alt="image-20221222001339919"></p>
<p><strong>功能</strong>:</p>
<ul>
<li>搜索：按列搜索，依然是模糊搜索。全部列都提供搜索操作。</li>
<li>编辑：利用一个对话编辑指定课程的信息，可以编辑的信息包括所有的列。</li>
<li>删除：可以删除学生信息，删除的时候要考虑后端信息。</li>
</ul>
<h3 id="4-5-2-学生名单"><a href="#4-5-2-学生名单" class="headerlink" title="4.5.2 学生名单"></a>4.5.2 学生名单</h3><p><img src="/posts/c89ebf90/image-20221222001656642.png" alt="image-20221222001656642"></p>
<p><strong>功能</strong>：</p>
<ul>
<li>搜索：按列提供关于所有信息的模糊搜索，比如说 <code>203</code> 可以搜索出 <code>20373249, 20373250</code> 之类的。除了团队并不提供这个操作。前端可以提供输入的内容，还有在搜索啥，比如说“学号-““203””。</li>
<li>编辑：利用一个对话编辑指定学生的信息，可以编辑的信息包括所有的列。</li>
<li>删除：可以删除学生信息，删除的时候要考虑后端信息。</li>
</ul>
<hr>
<h1 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h1><p>现在时间是 2022 年 12 月 20 日，如果从 9 月份项目立项开始算起，Go走马已经是一个 4 个月大的宝宝了。这四个月里，我们仨人每周开一次组会，不定期的在群里讨论问题，互相吸取长处，一起解决困难，有了十足的进步。</p>
<p>在设计层面，给我印象最深的是<strong>需求分析调研</strong>。在做第一版作业的时候，我们没有太看重这个环节，但是后来发现之前的模型是没有办法让数据“流畅”的流通起来的，后来在第二版作业的时候，才开始认认真真去写设计文档，先是发调研文卷，然后整理调研结果，全组人一起线下讨论数据流图和 ER 图，正确消除功能上的缺憾，感觉第二版作业的完成度和完备性都要高于第一版，可以说最大的原因就是有了充分的调研和设计。</p>
<p>在功能层面，给我印象最深的是<strong>推荐机制</strong>的实现。当时在一次组会中，陶思远提到有没有办法让数据库中的数据被更多，更加有趣的使用。我想到如果只是让用户去使用数据，那么其实使用的方法十分单一，其方式其实取决于前端定义的方式。但是推荐机制并不是用户在使用数据，而是数据库应用在使用数据，他们通过分析数据库中的数据，提炼出有价值的信息，然后反馈给用户，这样的使用是我们之前没有想过的。但是正是因为先例很少，我们对于这个方向的工作一直没有很大的进展。后来是听郎老师上课，讲到她的实验室好像有一个课题就是关于数据分析的，然后我才意识到这个不是数据库的一个子功能，而是一个与数据库可以等量齐观的学问。之后有看了教材和课件上关于“数据仓库”的介绍，才对于这个功能有了一定的认识，之后有看了往届的设计实现报告里面的介绍，最终才实现了一个功能上说得过去的推荐机制。</p>
<p>在实现层面，给我印象最深的<strong>数据库和后端在云端的部署</strong>。这个涉及了很多我们之前学过的知识，比如说操作系统的权限，还有数据库的权限问题，还有一些我们没有学过的机制，比如说一些计网的知识，十分困难。当时我和陈凝香，在大运村的广场上一直捣鼓到不知道几点，就记得，当时连廊外的路灯十分像月亮。所幸最终的效果十分理想，我们的部署是自动化的，而且功能强大，在实验的后期，我们帮助了多个小组的同学解决了服务器租赁，部署，图床等问题，看到大家在我们的帮助下都能将自己的作品变得更好，我们感到十分的自豪。</p>
<p>一路走来，非常感谢老师和助教的帮助，我们还记得郎老师在下课后为我们解决问题，助教哥哥们在听了我们的中期汇报后给出了十分有建设性的建议，在开完会之后我们纠正了对于文件上传功能的执着，将设计和实现的焦点放在了与课程更加贴近的数据库设计和管理上，这才有了后面理论和实践相结合，知行合一的良好体验。在答疑的时候也帮我们解决过具体的问题。没有他们，我们走不到今天这一步。</p>
<p>最后放上我们的共同回忆留作纪念。</p>
<p><img src="/posts/c89ebf90/image-20230105122315380.png" alt="image-20230105122315380"></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%9B%B4%E8%A7%82%E7%90%86%E8%A7%A3/" rel="tag"><i class="fa fa-tag"></i> 直观理解</a>
              <a href="/tags/DBMS/" rel="tag"><i class="fa fa-tag"></i> DBMS</a>
              <a href="/tags/S5%E8%AF%BE%E4%B8%8A/" rel="tag"><i class="fa fa-tag"></i> S5课上</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/fe0a8753/" rel="prev" title="DBMS-设计报告">
      <i class="fa fa-chevron-left"></i> DBMS-设计报告
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/945fe948/" rel="next" title="语言高阶-Py_import">
      语言高阶-Py_import <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
<script src="https://utteranc.es/client.js"
        repo="Thysrael/blog-comment"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">一、系统结构设计</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-text">1.1 体系结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-%E6%80%BB%E4%BD%93%E7%BB%93%E6%9E%84"><span class="nav-text">1.1.1 总体结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-%E5%89%8D%E7%AB%AF%E7%BB%93%E6%9E%84"><span class="nav-text">1.1.2 前端结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-%E5%90%8E%E7%AB%AF%E7%BB%93%E6%9E%84"><span class="nav-text">1.1.3 后端结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-4-%E6%96%87%E6%A1%A3%E6%9E%B6%E6%9E%84"><span class="nav-text">1.1.4 文档架构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0%E7%8E%AF%E5%A2%83"><span class="nav-text">1.2 系统实现环境</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%8E%AF%E5%A2%83"><span class="nav-text">1.2.1 客户端环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF"><span class="nav-text">1.2.2 服务器端</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E5%8A%9F%E8%83%BD%E7%BB%93%E6%9E%84"><span class="nav-text">1.3 功能结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C"><span class="nav-text">1.3.1 登录注册</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-%E4%BD%93%E8%82%B2%E8%AF%BE%E7%A8%8B"><span class="nav-text">1.3.2 体育课程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-3-%E4%BD%93%E8%82%B2%E6%B4%BB%E5%8A%A8"><span class="nav-text">1.3.3 体育活动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-4-%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF"><span class="nav-text">1.3.4 个人信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-5-%E7%AE%A1%E7%90%86%E7%AB%AF"><span class="nav-text">1.3.5 管理端</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%9F%BA%E6%9C%AC%E8%A1%A8%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-text">二、数据基本表的定义</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E9%83%A8%E5%88%86"><span class="nav-text">2.1 用户管理部分</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-%E5%AD%A6%E7%94%9F%E8%A1%A8"><span class="nav-text">2.1.1 学生表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-%E6%95%99%E5%B8%88%E8%A1%A8"><span class="nav-text">2.1.2 教师表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E8%AF%BE%E7%A8%8B%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%83%A8%E5%88%86"><span class="nav-text">2.2 课程管理系统部分</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-%E8%AF%BE%E7%A8%8B%E8%A1%A8"><span class="nav-text">2.2.1 课程表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-%E5%AD%A6%E7%94%9F-%E8%AF%BE%E7%A8%8B%E8%A1%A8"><span class="nav-text">2.2.2 学生-课程表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-3-%E6%95%99%E5%B8%88-%E8%AF%BE%E7%A8%8B%E8%A1%A8"><span class="nav-text">2.2.3 教师-课程表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-4-%E4%BD%9C%E4%B8%9A%E8%A1%A8"><span class="nav-text">2.2.4 作业表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-5-%E4%BD%9C%E4%B8%9A%E6%8F%90%E4%BA%A4%E8%A1%A8"><span class="nav-text">2.2.5 作业提交表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-6-%E9%80%9A%E7%9F%A5%E8%A1%A8"><span class="nav-text">2.2.6 通知表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E6%B4%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E9%83%A8%E5%88%86"><span class="nav-text">2.3 活动管理部分</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-%E6%B4%BB%E5%8A%A8%E8%A1%A8"><span class="nav-text">2.3.1 活动表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-%E5%AD%A6%E7%94%9F-%E6%B4%BB%E5%8A%A8%E8%A1%A8"><span class="nav-text">2.3.2 学生-活动表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E9%83%A8%E5%88%86"><span class="nav-text">2.4 个人信息部分</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-1-%E5%AD%A6%E7%94%9F-%E4%BD%93%E6%B5%8B%E6%88%90%E7%BB%A9%E8%A1%A8"><span class="nav-text">2.4.1 学生-体测成绩表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E5%85%B6%E4%BB%96"><span class="nav-text">2.5 其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-1-%E5%9B%BE%E7%89%87%E7%AE%A1%E7%90%86%E8%A1%A8"><span class="nav-text">2.5.1 图片管理表</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%B3%BB%E7%BB%9F%E9%87%8D%E8%A6%81%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95"><span class="nav-text">三、系统重要功能实现方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-%E9%89%B4%E6%9D%83%E5%AE%9E%E7%8E%B0"><span class="nav-text">3.1 鉴权实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-token%E6%9C%BA%E5%88%B6"><span class="nav-text">3.1.1 token机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-%E8%B7%AF%E7%94%B1%E5%AE%88%E6%8A%A4"><span class="nav-text">3.1.2 路由守护</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95"><span class="nav-text">3.2 推荐算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-text">3.3 文件上传</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E5%9B%BE%E5%BA%8A"><span class="nav-text">3.4 图床</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8C%B9%E9%85%8D"><span class="nav-text">3.5 动态路由匹配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-text">3.6 触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-text">3.7 存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-1-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%EF%BC%88%E7%99%BB%E5%BD%95-%E6%B3%A8%E5%86%8C%EF%BC%89"><span class="nav-text">3.7.1 用户管理（登录&#x2F;注册）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-2-%E8%AF%BE%E7%A8%8B%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.7.2 课程系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-2-1-%E7%AE%A1%E7%90%86%E5%91%98%E7%9B%B8%E5%85%B3"><span class="nav-text">3.7.2.1 管理员相关</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-2-2-%E5%AD%A6%E7%94%9F%E7%9B%B8%E5%85%B3"><span class="nav-text">3.7.2.2 学生相关</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-2-3-%E6%95%99%E5%B8%88%E7%9B%B8%E5%85%B3"><span class="nav-text">3.7.2.3 教师相关</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-3-%E6%B4%BB%E5%8A%A8%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.7.3 活动系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-4-%E7%AE%A1%E7%90%86%E5%91%98%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.7.4 管理员系统</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C"><span class="nav-text">四、系统实现效果</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C"><span class="nav-text">4.1 登录注册</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1-%E9%A6%96%E9%A1%B5"><span class="nav-text">4.1.1 首页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-2-%E7%99%BB%E5%BD%95"><span class="nav-text">4.1.2 登录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-3-%E6%B3%A8%E5%86%8C"><span class="nav-text">4.1.3 注册</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-4-%E7%99%BB%E5%87%BA"><span class="nav-text">4.1.4 登出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-5-%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81"><span class="nav-text">4.1.5 修改密码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E4%BD%93%E8%82%B2%E8%AF%BE%E7%A8%8B"><span class="nav-text">4.2 体育课程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1-%E8%AF%BE%E7%A8%8B%E8%AF%A6%E6%83%85"><span class="nav-text">4.2.1 课程详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-%E4%BD%9C%E4%B8%9A%E6%8F%90%E4%BA%A4"><span class="nav-text">4.2.2 作业提交</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3-%E4%BD%9C%E4%B8%9A%E6%94%B6%E5%8F%96"><span class="nav-text">4.2.3 作业收取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-4-%E7%8F%AD%E7%BA%A7%E7%AE%A1%E7%90%86"><span class="nav-text">4.2.4 班级管理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E4%BD%93%E8%82%B2%E6%B4%BB%E5%8A%A8"><span class="nav-text">4.3 体育活动</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1-%E6%B4%BB%E5%8A%A8%E4%B8%AD%E5%BF%83"><span class="nav-text">4.3.1 活动中心</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2-%E5%88%9B%E5%BB%BA%E6%B4%BB%E5%8A%A8"><span class="nav-text">4.3.2 创建活动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-3-%E6%B4%BB%E5%8A%A8%E8%AF%A6%E6%83%85"><span class="nav-text">4.3.3 活动详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-4-%E6%88%91%E7%9A%84%E6%B4%BB%E5%8A%A8"><span class="nav-text">4.3.4 我的活动</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF"><span class="nav-text">4.4 个人信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-1-%E4%BD%93%E8%82%B2%E9%94%BB%E7%82%BC"><span class="nav-text">4.4.1 体育锻炼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-2-%E4%BD%93%E6%B5%8B%E6%88%90%E7%BB%A9"><span class="nav-text">4.4.2 体测成绩</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-%E7%AE%A1%E7%90%86%E7%AB%AF"><span class="nav-text">4.5 管理端</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-1-%E8%AF%BE%E7%A8%8B%E5%90%8D%E5%8D%95"><span class="nav-text">4.5.1 课程名单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-2-%E5%AD%A6%E7%94%9F%E5%90%8D%E5%8D%95"><span class="nav-text">4.5.2 学生名单</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-text">五、总结</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Thysrael"
      src="/images/avatar2.png">
  <p class="site-author-name" itemprop="name">Thysrael</p>
  <div class="site-description" itemprop="description">Can you hear me?</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">203</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">70</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="">
    <a target="_blank" class="social-link" href="/atom.xml" style="color: burlywood;">
      <span class="icon">
        <i class="fa fa-rss"></i>
      </span>
      <span class="label">RSS</span>
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/thysrael" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;thysrael" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:thysrael@163.com" title="E-Mail → mailto:thysrael@163.com" rel="noopener external nofollow noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021.12.18 – 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Thysrael</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1.4m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">20:32</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams',
        macros: {
          unicodeInt: ['\\mathop{\\vcenter{\\mathchoice{\\huge\\unicode{#1}}{\\unicode{#1}}{\\unicode{#1}}{\\unicode{#1}}}}\\nolimits', 1],
          oiint: '\\unicodeInt{x222F}',
          oiiint: '\\unicodeInt{x2230}'
        }
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
